<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Attendance History</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../assets/css/variables.css">
    <link rel="stylesheet" href="../assets/css/global.css">
    <script src="https://unpkg.com/lucide@latest"></script>
</head>

<body>
    <main class="main-content fade-in-up">
        <h2 class="fw-bold text-primary mb-4">Full Attendance History</h2>

        <div class="glass-card">
            <table class="table align-middle mb-0" style="background:transparent">
                <thead class="text-secondary small text-uppercase">
                    <tr>
                        <th class="ps-4 border-0">Date</th>
                        <th class="text-center border-0">S1</th>
                        <th class="text-center border-0">S2</th>
                        <th class="text-center border-0">S3</th>
                        <th class="text-end pe-4 border-0">Daily Status</th>
                    </tr>
                </thead>
                <tbody id="histBody">
                    <tr>
                        <td colspan="5" class="text-center py-4">Loading...</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </main>

    <script src="../shared/config.js"></script>
    <script src="../shared/utils.js"></script>
    <script src="../shared/api.js"></script>
    <script src="../shared/auth.js"></script>
    <script src="../shared/student-layout.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            const data = await api.get('/api/student/attendance');
            const tbody = document.getElementById('histBody');
            tbody.innerHTML = '';

            if (data && data.length > 0) {
                data.forEach(r => {
                    tbody.innerHTML += `
                         <tr>
                             <td class="ps-4 fw-bold text-secondary">${Utils.formatDate(r.date)}</td>
                             <td class="text-center">${Utils.getBadge(r.session1Status)}</td>
                             <td class="text-center">${Utils.getBadge(r.session2Status)}</td>
                             <td class="text-center">${Utils.getBadge(r.session3Status)}</td>
                             <td class="text-end pe-4">${Utils.getBadge(r.dailyStatus)}</td>
                         </tr>
                     `;
                });
            } else {
                tbody.innerHTML = '<tr><td colspan="5" class="text-center py-4 text-muted">No records.</td></tr>';
            }
        });
    </script>
</body>

</html>